<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recorrido Virtual - Propiedad</title>
<style>
:root{
  --color-primario:#e4943a;
  --color-secundario:#a05e37;
  --fondo:#1b1b1b;
  --panel:#242424;
  --widget:#2d2d2d;
  --texto:#fff;
  --texto-secundario:#cfcfcf;
}
html,body{
  height:100%;margin:0;
  font-family:'Poppins',Arial,sans-serif;
  background:var(--fondo);color:var(--texto);
  display:flex;flex-direction:column;
}

/* HEADER */
header{
  position:fixed;top:0;left:0;width:100%;height:65px;
  background:rgba(0,0,0,0.6);display:flex;align-items:center;
  padding:0 20px;z-index:1000;backdrop-filter:blur(6px);
  box-shadow:0 2px 6px rgba(0,0,0,.4);
}
header img{height:42px;margin-right:12px}
header h1{
  font-size:18px;color:var(--color-primario);
  margin:0;font-weight:600;flex:1;
}
#btn-menu{
  display:none;background:none;border:none;color:var(--texto);
  font-size:30px;cursor:pointer;position:absolute;
  right:25px;top:50%;transform:translateY(-50%);
  padding:10px 12px;border-radius:8px;z-index:1500;
  transition:background 0.3s ease;
}
#btn-menu:hover{background:rgba(255,255,255,0.1)}

/* ESTRUCTURA PRINCIPAL */
.content{
  display:flex;flex:1;height:calc(100vh - 65px);
  margin-top:65px;overflow:hidden;
}
.main{
  flex:3;background:#000;display:flex;
  align-items:center;justify-content:center;
}
.main iframe{width:100%;height:100%;border:none;overflow:hidden}
.sidebar{
  flex:1;background:var(--panel);padding:15px;height:100%;
  overflow-y:auto;scrollbar-width:thin;
  scrollbar-color:var(--color-primario)#1b1b1b;
  transition:transform 0.4s ease-in-out;
}
.sidebar::-webkit-scrollbar{width:8px}
.sidebar::-webkit-scrollbar-thumb{
  background-color:var(--color-primario);border-radius:4px;
}

/* Widgets */
.widget{
  background:var(--widget);border-radius:12px;
  padding:15px;margin-bottom:15px;
  box-shadow:0 4px 10px rgba(0,0,0,.3);
  transition:transform .3s,box-shadow .3s;
}
.widget:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 15px rgba(0,0,0,.4);
}
.widget h2,.widget h3{
  font-size:15px;margin:0 0 10px;color:var(--texto);
  background:rgba(0,0,0,.4);padding:6px 10px;
  border-radius:6px;text-transform:uppercase;
}

/* Im√°genes */
.plano img,.galeria .grid img{
  width:100%;border-radius:8px;cursor:pointer;
  transition:transform .3s;
}
.plano img:hover,.galeria .grid img:hover{transform:scale(1.01)}

/* Ficha t√©cnica */
.ficha table{width:100%;border-collapse:collapse;font-size:14px}
.ficha td{padding:6px 0;border-bottom:1px solid #444}

/* Lugares */
.lugares ul{list-style:none;padding:0;margin:0 0 10px;font-size:14px}
.lugares li{margin:6px 0;color:var(--texto-secundario)}
.btn-vermas{
  width:100%;padding:10px;border:none;border-radius:8px;
  background:var(--color-primario);color:#fff;
  font-size:14px;cursor:pointer;transition:background .3s;
}
.btn-vermas:hover{background:var(--color-secundario)}

/* Galer√≠a */
.galeria .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}

/* Lightbox global */
#visor,#visor-plano{
  display:none;position:fixed;inset:0;
  background:rgba(0,0,0,0.9);
  justify-content:center;align-items:center;
  z-index:30000;
}
#visor img,#visor-plano img{
  max-width:90%;max-height:90%;
  border-radius:12px;object-fit:contain;
  box-shadow:0 0 20px rgba(0,0,0,0.6);
  animation:zoomIn 0.25s ease;
}
@keyframes zoomIn{
  from{transform:scale(0.85);opacity:0}
  to{transform:scale(1);opacity:1}
}

/* Widget BIM */
#widget-bim{
  background:rgba(30,30,30,.95);padding:10px;border-radius:12px;
  box-shadow:0 0 8px rgba(0,0,0,.3);
}
.bim-controls{
  display:flex;justify-content:center;gap:8px;margin-top:6px;
}
.bim-controls button{
  background:#444;color:#fff;border:none;
  padding:5px 10px;border-radius:6px;
  cursor:pointer;transition:background .3s;
}
.bim-controls button:hover{background:#666}

/* Modal fullscreen BIM */
#modal-bim{
  display:none;position:fixed;inset:0;
  background:rgba(0,0,0,.96);
  justify-content:center;align-items:center;
  z-index:10000;
}
#modal-bim model-viewer{
  width:90%;height:80%;
  border-radius:12px;background:#222;
  z-index:10001;
}
#btnCerrarBIM{
  position:absolute;top:20px;right:20px;
  background:rgba(0,0,0,0.65);
  border:none;color:#fff;cursor:pointer;
  border-radius:50%;width:52px;height:52px;
  font-size:28px;display:flex;align-items:center;
  justify-content:center;
  box-shadow:0 0 10px rgba(0,0,0,0.6);
  transition:background .3s;z-index:20000;
}
#btnCerrarBIM:hover{background:rgba(255,255,255,0.15)}
#btnCerrarBIM span{
  position:absolute;bottom:-22px;left:50%;
  transform:translateX(-50%);
  font-size:13px;color:#fff;opacity:0.9;
  text-shadow:0 0 4px #000;
}

/* RESPONSIVE */
@media(max-width:900px){
  #btn-menu{display:block}
  .content{flex-direction:row}
  .sidebar{
    position:fixed;top:65px;right:0;width:70%;
    max-width:350px;height:calc(100vh - 65px);
    transform:translateX(100%);
    z-index:1200;
  }
  .sidebar.active{transform:translateX(0)}
  #overlay{
    display:none;position:fixed;inset:0;
    background:rgba(0,0,0,.4);
    z-index:1100;backdrop-filter:blur(2px);
  }
  #overlay.show{display:block}
}
</style>
</head>
<body>
<header>
  <img src="imagenes/logo.png" alt="Logo Torres Santa Catalina">
  <button id="btn-menu">‚ò∞</button>
</header>

<div id="overlay"></div>

<div class="content">
  <div class="main">
    <iframe src="torres-santa-catalina/app-files/index.html"></iframe>
  </div>

  <div class="sidebar" id="sidebar">
    <div class="widget" id="widget-bim">
      <h3>Modelado 3D</h3>
      <model-viewer id="bimModel"
                    src="static/models/casa.glb"
                    alt="Modelo BIM de la casa"
                    camera-controls
                    auto-rotate
                    shadow-intensity="1"
                    exposure="0.9"
                    environment-image="neutral"
                    interaction-prompt="none"
                    style="width:100%;height:300px;border-radius:12px;background-color:#222;">
      </model-viewer>
      <div class="bim-controls">
        <button id="btnExpandirBIM">‚õ∂ Pantalla completa</button>
      </div>
    </div>

    <div class="widget plano">
      <h2>Plano de la Casa</h2>
      <img src="imagenes/plano_casa_pb.jpg" alt="Planta baja" onclick="abrirPlano(this)">
    </div>

    <div class="widget ficha">
      <h2>Ficha T√©cnica</h2>
      <table>
        <tr><td>üè† Construcci√≥n:</td><td>71.30 m¬≤</td></tr>
        <tr><td>üå≥ √Årea balc√≥n:</td><td>5.79 m¬≤</td></tr>
        <tr><td>üõè Habitaciones:</td><td>3</td></tr>
        <tr><td>üöΩ Ba√±os:</td><td>2</td></tr>
        <tr><td>üöó Parqueaderos:</td><td>1</td></tr>
        <tr><td>üìÖ A√±o:</td><td>2024</td></tr>
      </table>
    </div>

    <div class="widget lugares">
      <h2>Lugares Cercanos</h2>
      <ul>
        <li>üõí Supermercado ‚Äî <strong>5 min en auto</strong></li>
        <li>üè´ Escuela ‚Äî <strong>3 min caminando</strong></li>
        <li>üè• Hospital ‚Äî <strong>7 min en auto</strong></li>
        <li>üå≥ Parque ‚Äî <strong>4 min caminando</strong></li>
      </ul>
      <button class="btn-vermas" onclick="window.location.href='widget-poi/index.html'">Ver todos los lugares cercanos</button>
    </div>

    <div class="widget galeria">
      <h2>Galer√≠a de Fotos</h2>
      <div class="grid">
        <img src="imagenes/foto1.jpg" alt="Foto 1" onclick="abrir(this)">
        <img src="imagenes/foto2.jpg" alt="Foto 2" onclick="abrir(this)">
      </div>
    </div>
  </div>
</div>

<!-- Lightbox globales -->
<div id="visor" onclick="cerrar()">
  <img id="visor-img">
</div>
<div id="visor-plano" onclick="cerrarPlano()">
  <img id="visor-plano-img">
</div>

<!-- Modal BIM -->
<div id="modal-bim">
  <button id="btnCerrarBIM">‚úñ<span>Cerrar</span></button>
  <model-viewer src="static/models/casa.glb" camera-controls auto-rotate
                shadow-intensity="1" exposure="0.9"
                environment-image="neutral"
                style="width:100%;height:100%;border-radius:12px;background:#222;">
  </model-viewer>
</div>

<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
<script>
/* ==================== PANEL LATERAL ==================== */
const sidebar=document.getElementById('sidebar');
const overlay=document.getElementById('overlay');
const menuBtn=document.getElementById('btn-menu');
menuBtn.addEventListener('click',()=>{
  sidebar.classList.toggle('active');
  overlay.classList.toggle('show');
});
overlay.addEventListener('click',()=>{
  sidebar.classList.remove('active');
  overlay.classList.remove('show');
});

/* ==================== MODAL BIM ==================== */
document.addEventListener('DOMContentLoaded', () => {
  const modalBIM = document.getElementById('modal-bim');
  const btnExpandirBIM = document.getElementById('btnExpandirBIM');
  const btnCerrarBIM = document.getElementById('btnCerrarBIM');

  if (btnExpandirBIM && modalBIM) {
    btnExpandirBIM.addEventListener('click', () => {
      modalBIM.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    });
  }

  if (btnCerrarBIM && modalBIM) {
    btnCerrarBIM.addEventListener('click', () => {
      modalBIM.style.display = 'none';
      document.body.style.overflow = 'auto';
    });
  }
});

/* ==================== LIGHTBOX ==================== */
function abrir(img){
  document.getElementById('visor').style.display='flex';
  document.getElementById('visor-img').src=img.src;
}
function cerrar(){
  document.getElementById('visor').style.display='none';
}
function abrirPlano(img){
  document.getElementById('visor-plano').style.display='flex';
  document.getElementById('visor-plano-img').src=img.src;
}
function cerrarPlano(){
  document.getElementById('visor-plano').style.display='none';
}
</script>
</body>
</html>
